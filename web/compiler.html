<!DOCTYPE html>
<html lang="en" class="h-full scroll-smooth">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>512lang Compiler</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link
		href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Inter:wght@400;500;600;700;800&display=swap"
		rel="stylesheet">
	<script src="https://cdn.tailwindcss.com?plugins=typography"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="site.css" />
	<!-- Monaco Editor loader -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.47.0/min/vs/loader.min.js"></script>
</head>

<body class="min-h-full bg-slate-950 text-slate-100 antialiased selection:bg-fuchsia-600/40 selection:text-fuchsia-100">
	<div id="site-header"></div>

	<main class="max-w-7xl mx-auto px-5 py-6">
		<!-- Mobile Tabs -->
		<div class="lg:hidden mb-3 flex border-b border-slate-700/60">
			<button id="tabCode"
				class="flex-1 py-2 text-center text-sm font-medium text-slate-300 border-b-2 border-fuchsia-600">
				Code
			</button>
			<button id="tabOutput"
				class="flex-1 py-2 text-center text-sm font-medium text-slate-400 border-b-2 border-transparent">
				Output
			</button>
		</div>

		<!-- Layout -->
		<div class="flex flex-col gap-6 lg:grid lg:grid-cols-[12rem_minmax(0,1fr)_16rem]" id="layoutGrid">

			<!-- Examples Sidebar (desktop only) -->
			<div class="relative order-1 hidden lg:block">
				<aside id="examplesSidebar"
					class="bg-slate-900/60 border border-slate-800/60 rounded-lg flex flex-col overflow-hidden backdrop-blur-sm h-[70vh]">
					<!-- Search bar only on desktop -->
					<div class="p-3 border-b border-slate-800/40 hidden lg:block">
						<input id="exampleSearch" type="text" placeholder="Search…"
							class="w-full text-xs px-2.5 py-1.5 rounded-md bg-slate-800/70 border border-slate-700/70 focus:outline-none focus:ring-1 focus:ring-fuchsia-600 placeholder-slate-500" />
					</div>
					<!-- Scrollable list -->
					<ul id="examplesList" class="flex-1 overflow-y-auto py-2 text-xs divide-y divide-slate-800/40"></ul>
					<div
						class="p-3 text-[10px] leading-relaxed text-slate-500 bg-slate-950/40 border-t border-slate-800/60">
						Click an example to load it into the editor.
					</div>
				</aside>
			</div>

			<!-- Editor -->
			<section id="editorPanel"
				class="bg-slate-900/80 border border-slate-800/60 rounded-lg overflow-hidden flex flex-col order-2 min-h-[70vh]">
				<div class="flex items-center justify-between px-4 py-2 bg-slate-800/60 border-b border-slate-700/60">
					<div class="flex items-center gap-3">
						<span class="text-sm text-slate-300 font-mono">editor.512</span>
						<!-- Zoom controls: increase/decrease editor font size -->
						<div class="ml-2 inline-flex items-center gap-1 mr-2 lg:mr-0">
							<button id="zoomOutBtn" title="Zoom out" aria-label="Zoom out"
								class="w-6 h-5 sm:w-7 sm:h-6 flex items-center justify-center text-xs sm:text-sm rounded-md bg-slate-800/60 border border-slate-700/60 hover:bg-slate-800/80">−</button>
							<button id="zoomInBtn" title="Zoom in" aria-label="Zoom in"
								class="w-6 h-5 sm:w-7 sm:h-6 flex items-center justify-center text-xs sm:text-sm rounded-md bg-slate-800/60 border border-slate-700/60 hover:bg-slate-800/80">+</button>
						</div>
					</div>
					<div class="flex items-center gap-2">
						<button id="runBtn"
							class="px-3 py-1.5 text-sm rounded-md bg-fuchsia-600 hover:bg-fuchsia-500 text-white">Compile</button>
						<button id="resetBtn"
							class="px-3 py-1.5 text-sm rounded-md border border-slate-600 hover:border-slate-500 text-slate-200">Reset</button>
					</div>
				</div>
				<div id="editor" class="font-mono flex-1" style="height:65vh"></div>
			</section>

			<!-- Output -->
			<section id="outputPanel"
				class="bg-slate-900/80 border border-slate-800/60 rounded-lg overflow-hidden flex flex-col order-3 min-h-[70vh] hidden lg:flex">
				<div class="flex items-center justify-between px-4 py-2 bg-slate-800/60 border-b border-slate-700/60">
					<span class="text-sm text-slate-300 font-mono">output</span>
					<div class="text-xs text-slate-500" id="status">idle</div>
				</div>
				<div class="p-4 flex-1">
					<!-- Make the output pane independently scrollable -->
					<pre id="output"
						class="text-sm text-slate-300 font-mono leading-relaxed whitespace-pre-wrap overflow-auto max-h-[60vh]"></pre>
				</div>
			</section>
		</div>

		<!-- Mobile Examples Drawer -->
		<div class="lg:hidden mt-4">
			<details class="bg-slate-900/80 border border-slate-800/60 rounded-lg overflow-hidden">
				<summary
					class="cursor-pointer px-3 py-2 text-sm font-medium text-slate-300 bg-slate-800/60 border-b border-slate-700/60">
					Show Examples
				</summary>
				<ul id="examplesListMobile" class="max-h-60 overflow-y-auto text-xs divide-y divide-slate-800/40 p-2">
				</ul>
			</details>
		</div>
	</main>

	<div id="site-footer"></div>

	<script src="shared.js"></script>
	<script src="compiler.js" defer></script>
	<script>injectLayout('compiler');</script>

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			const tabCode = document.getElementById('tabCode');
			const tabOutput = document.getElementById('tabOutput');
			const editorPanel = document.getElementById('editorPanel');
			const outputPanel = document.getElementById('outputPanel');
			const runBtn = document.getElementById('runBtn');

			function showTab(tab) {
				if (tab === 'code') {
					editorPanel.classList.remove('hidden');
					outputPanel.classList.add('hidden');

					tabCode.classList.add('text-slate-300', 'border-fuchsia-600');
					tabCode.classList.remove('text-slate-400', 'border-transparent');

					tabOutput.classList.remove('text-slate-300', 'border-fuchsia-600');
					tabOutput.classList.add('text-slate-400', 'border-transparent');
				} else {
					outputPanel.classList.remove('hidden');
					editorPanel.classList.add('hidden');

					tabOutput.classList.add('text-slate-300', 'border-fuchsia-600');
					tabOutput.classList.remove('text-slate-400', 'border-transparent');

					tabCode.classList.remove('text-slate-300', 'border-fuchsia-600');
					tabCode.classList.add('text-slate-400', 'border-transparent');
				}
			}

			tabCode.addEventListener('click', () => showTab('code'));
			tabOutput.addEventListener('click', () => showTab('output'));

			// Switch to output after compile only on small screens
			runBtn.addEventListener('click', () => {
				if (window.innerWidth < 1024) { // matches Tailwind's lg breakpoint
					showTab('output');
				} else {
					// On desktop keep both editor and output visible; scroll output into view
					const out = document.getElementById('output');
					if (out) out.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
				}
			});

			// Examples are populated from `compiler.js` (compilerPageExamples)
		});
	</script>
</body>

</html>